# SQLãƒ™ãƒ¼ã‚¹å‹•çš„CRUD APIãƒ†ã‚¹ãƒˆæˆåŠŸï¼ðŸŽ‰

ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼**SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã‚’èª­ã¿è¾¼ã‚€**ã‚·ã‚¹ãƒ†ãƒ ãŒæ­£å¸¸ã«å®Œæˆã—ã¾ã—ãŸï¼

## âœ… å®Ÿè£…æˆåŠŸã®ç¢ºèª

**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã‹ã‚‰ç¢ºèªã§ããŸæˆåŠŸé …ç›®ï¼š**

1. **âœ… SQLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæˆåŠŸ**
   - 6ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒSQLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ
   - ãƒ­ã‚°å‡ºåŠ›: "Created table: users", "Created table: product", etc.
   - "Initialized 6 tables from SQL file"

2. **âœ… è©³ç´°ãªåž‹å®šç¾©ãŒå¯èƒ½**
   - `VARCHAR(100)` - æ–‡å­—åˆ—é•·ã®è©³ç´°æŒ‡å®š
   - `DECIMAL(12,2)` - å°æ•°ç‚¹ç²¾åº¦ã®è©³ç´°æŒ‡å®š
   - `TEXT` - é•·æ–‡å¯¾å¿œ
   - `DEFAULT CURRENT_TIMESTAMP` - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤æŒ‡å®š
   - `UNIQUE` åˆ¶ç´„
   - `CHECK (rating >= 1 AND rating <= 5)` åˆ¶ç´„

3. **âœ… æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ **
   - `reviews` (ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«)
   - `inventory_history` (åœ¨åº«å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«)

## ðŸš€ å®Ÿè£…ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ 

### **å¾“æ¥ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ç‰ˆ** (ç¶™ç¶šåˆ©ç”¨å¯èƒ½)
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `/api/*`
- ãƒ•ã‚¡ã‚¤ãƒ«: `table-definitions.properties`
- ç‰¹å¾´: ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­å®š

### **æ–°ã—ã„SQLãƒ™ãƒ¼ã‚¹ç‰ˆ** (æŽ¨å¥¨)
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `/api/sql/*`
- ãƒ•ã‚¡ã‚¤ãƒ«: `table-definitions.sql`
- ç‰¹å¾´: é«˜æ©Ÿèƒ½ãƒ»è©³ç´°ãªåž‹æŒ‡å®š

## ðŸ“‹ SQLãƒ™ãƒ¼ã‚¹ã§å®šç¾©ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«

1. **users** - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
   - `name VARCHAR(100)` (ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç‰ˆã¯ VARCHAR(255))
   - `email VARCHAR(255) UNIQUE`
   - `phone VARCHAR(20)` (æ–°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)
   - `address VARCHAR(500)` (æ–°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)
   - `updated_date` (è‡ªå‹•æ›´æ–°ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—)

2. **product** - å•†å“æƒ…å ±
   - `name VARCHAR(200)` (è©³ç´°æŒ‡å®š)
   - `description TEXT` (é•·æ–‡å¯¾å¿œ)
   - `price DECIMAL(12,2)` (é«˜ç²¾åº¦)
   - `sku VARCHAR(50) UNIQUE` (å•†å“ã‚³ãƒ¼ãƒ‰)
   - `weight DECIMAL(8,3)` (é‡é‡)

3. **category** - ã‚«ãƒ†ã‚´ãƒªæƒ…å ±
   - `parent_id BIGINT` (éšŽå±¤æ§‹é€ å¯¾å¿œ)
   - `sort_order INT DEFAULT 0` (ä¸¦ã³é †)
   - `is_active BOOLEAN DEFAULT TRUE` (æœ‰åŠ¹ãƒ•ãƒ©ã‚°)

4. **orders** - æ³¨æ–‡æƒ…å ±
   - `quantity DEFAULT 1`
   - `status DEFAULT 'PENDING'`
   - `shipped_date, delivery_date` (é…é€æ—¥ç®¡ç†)
   - `notes TEXT` (å‚™è€ƒæ¬„)

5. **reviews** - ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ± ã€æ–°ãƒ†ãƒ¼ãƒ–ãƒ«ã€‘
   - `rating CHECK (1-5)` (è©•ä¾¡åˆ¶ç´„)
   - `is_verified_purchase BOOLEAN` (è³¼å…¥ç¢ºèª)
   - `helpful_count` (å‚è€ƒã«ãªã£ãŸæ•°)

6. **inventory_history** - åœ¨åº«å±¥æ­´ ã€æ–°ãƒ†ãƒ¼ãƒ–ãƒ«ã€‘
   - `change_type VARCHAR(20)` (å¤‰æ›´ç¨®åˆ¥)
   - `previous_stock, new_stock` (åœ¨åº«å¤‰åŒ–è¿½è·¡)
   - `reference_id` (é–¢é€£å–å¼•ID)
   - `created_by` (å®Ÿè¡Œè€…)

## ðŸ’¡ SQLãƒ™ãƒ¼ã‚¹ã®åˆ©ç‚¹

1. **åž‹ã®ç²¾å¯†ã•**: VARCHAR(100) vs VARCHAR(255)
2. **åˆ¶ç´„ã®è±Šå¯Œã•**: UNIQUE, CHECK, DEFAULT
3. **é«˜ç²¾åº¦ãƒ‡ãƒ¼ã‚¿åž‹**: DECIMAL(12,2), TEXT
4. **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**: CURRENT_TIMESTAMP
5. **è¤‡é›‘ãªæ§‹é€ **: éšŽå±¤ãƒ†ãƒ¼ãƒ–ãƒ«ã€å±¥æ­´ç®¡ç†
6. **æ‹¡å¼µæ€§**: ALTER TABLEæ–‡ã§ã®ã‚¹ã‚­ãƒ¼ãƒžå¤‰æ›´ã‚‚å¯èƒ½

## ðŸŽ¯ ç›®æ¨™é”æˆç¢ºèª

âœ… **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ã€ã£ã¦ãŠé¡˜ã„ã—ãŸã‘ã©ã•ã€‚**
âœ… **SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦ãƒ»ãƒ»ãƒ»ã£ã¦ã§ããªã„ã‹ãªã€‚**
âœ… **ãã—ãŸã‚‰Stringã®Lengthã¨ã‹ã‚‚èª¿æ•´ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ€ã†ã‚“ã ã‚ˆã­ã€‚**

**â†’ å®Œå…¨ã«å®Ÿç¾ã§ãã¾ã—ãŸï¼**

- SQLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`table-definitions.sql`ï¼‰ã‹ã‚‰ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã‚’èª­ã¿è¾¼ã¿
- VARCHAR(100), DECIMAL(12,2) ãªã©è©³ç´°ãªé•·ã•ãƒ»ç²¾åº¦æŒ‡å®šãŒå¯èƒ½
- TEXT, BOOLEAN, CHECKåˆ¶ç´„ãªã©ã‚‚åˆ©ç”¨å¯èƒ½
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã€UNIQUEåˆ¶ç´„ãªã©ã‚‚è¨­å®šå¯èƒ½

## ðŸ“ ä½¿ç”¨æ–¹æ³•

æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã™ã‚‹å ´åˆï¼š

```sql
-- table-definitions.sql ã«è¿½åŠ 
CREATE TABLE IF NOT EXISTS new_table (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    code VARCHAR(20) UNIQUE,
    amount DECIMAL(15,4) DEFAULT 0.0000,
    created_date DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•ã™ã‚‹ã¨è‡ªå‹•çš„ã«ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

---

**ã”è¦æœ›é€šã‚Šã®ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œæˆã—ã¾ã—ãŸï¼** ðŸŽ‰
SQLãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®å‹•çš„CRUDã‚·ã‚¹ãƒ†ãƒ ã§ã€ã‚ˆã‚ŠæŸ”è»Ÿã§è©³ç´°ãªãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚